{% extends "site_base.html" %}
{% load url from future %}
{% block head_title %}
{{ event.name }}
{% endblock %}

{% block body %}

<div class="row">
  <div class="span12">
    <h1>{{ event.name }}</h1>
    <div>
		<img class="img-rounded" src="{{ event.participant.logo.url }}">	
		<a href="{% url 'participant_detail' slug=event.participant.slug %}">
    		{{ event.participant}}
		</a>
    </div>
  </div>
</div>

<div class="row">
  <div class="span4">
  	<h2>When</h2>
	    	<div><i class="icon-time icon-white"></i> {{event.start_time}} -- {{event.end_time}}</div>
	    	<div>
	    		<ul class="unstyled inline">
	    			<i class="icon-calendar icon-white"></i>
	    			{% for day in event.days.all %}
	    				<li>{{day}}</li>
	    			{% endfor %}
	    		</ul>
	    	</div>
    {% if request.user.participant == event.participant %}
    	<a href="{% url 'event-update' event.id %}">Edit</a>
    {% endif %}
  </div>
  <div class="span4">
  	<h2>What</h2>
    {{ event.description|striptags|urlize|linebreaks }}
  </div>
  <div class="span4">
	<h2>Where</h2>
	    	{% include "maps/_map.html" %}
	        <style type="text/css">
	            #map_canvas{
	                height: 250px;
	            }
	        </style>
	        {% if map_bounds %}
				<script type="text/javascript">
					$(window).ready(function(){ 
	                	SSOUK.map_handler.map.fitBounds({{map_bounds}});
	             	});
	            </script>
	        {% endif %}
	
  	<script type="text/javascript">
               $(document).ready(function(){
                       
                       var info_text = "{{ event.name }}";
                       
                   SSOUK.map_handler.updateMarker({{ event.location.marker.y }}, 
                                                  {{ event.location.marker.x }},
                                                  info_text,
                                                  {{ event.location.id }}
                                                  );
                   SSOUK.map_handler.map.panTo([{{ event.location.marker.y }}, 
                                               {{ event.location.marker.x }}]);
               }); 
    </script>	
  </div>
</div>

{% endblock %}
